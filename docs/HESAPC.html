<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
  body{
  font-family: system-ui,-apple-system,blinkmacsystemfont,"Segoe UI",roboto,"Helvetica Neue",arial,sans-serif,"Segoe UI Emoji";
  }
    .sidenav {
      height: 100%;
      width: 200px;
      position: fixed;
      z-index: 1;
      top: 0;
      left: 0;
      background-color: #F0F0F0;
      overflow-x: hidden;
      padding-left: 20px;
    }

    .sidenav a, .dropdown-btn {
      padding: 8px;
      text-decoration: none;
      font-size: 15px;
      color: #6666dd;
      display: block;
      width: 100%;
      text-align: left;
    }

    .sidenav a:hover, .dropdown-btn:hover {
      color: #6666dd;
	  background-color: #DCDCDC;
    }

    .main {
      margin-left: 200px;
	  width: 60%;
      font-size: 15px;
      padding: 0px 10px 10px;
      padding-top: 10px;
    }
	table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      overflow-x: auto;
    }
 
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
 
    th {
      background-color: #f2f2f2;
    }
 
    tbody {
      display: block;
      overflow-x: auto;
    }
 
    tr {
      display: table;
      width: 100%;
      box-sizing: border-box;
    }
 
    @media (min-width: 600px) {
      tbody {
        display: table-row-group;
        overflow-x: hidden;
      }
 
      tr {
        display: table-row;
      }
    }

    .active {
      background-color:#D0D0D0;
      color: #6666dd;
    }

    .dropdown-container {
      display: none;
      background-color: #F0F0F0;
      padding-left: 8px;
    }

    .fa-caret-down {
      float: right;
      padding-right: 8px;
    }

    @media screen and (max-width: 800px) {
      .sidenav { display: none; }
      .main { margin-left: 0; }
      .navbar-toggler {
        order: -1;
      }
      .close-icon {
        display: block;
        font-size: 24px;
        margin-right: 20px;
        cursor: pointer;
      }
    }
  </style>
  <title>Home | HES CDM Documentation</title>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="close-icon" onclick="toggleSidebar()">&#10006;</div>
  <div class="collapse navbar-collapse" id="navbarNav">
    <div class="sidenav" id="mySidebar">
		<a href="#section1" onclick="closeNav()" style="color:black; font-weight: 500;">HES CDM Documentation</a>
	  <hr>
	  <a href="index.html" onclick="closeNav()" style="color:#6666dd;">Home</a>
      <button class="dropdown-btn" style="border: none;" onclick="scrollToSection('section2')">HES APC<i class="fa fa-caret-down"></i> 
      </button>
      <div class="dropdown-container">
        <a href="#subsection1">PERSON</a>
		<a href="#subsection2">PROVIDER</a>
        <a href="#subsection3">VISIT_OCCURRENCE</a>
        <a href="#subsection4">VISIT_DETAIL</a>
		<a href="#subsection5">STEM</a>
      </div>
     </div>
  </div>
</nav>

<div class="main">
	<section id="section1">
      <h2>Hospital Episode Statistics (HES) Admitted Patient Care (APC)</h2>
      <p>These materials are meant to serve as documentation and reference for how the <a href="https://digital.nhs.uk/data-and-information/publications/statistical/hospital-admitted-patient-care-activity">HES APC</a> dataset was converted to the <a href="https://ohdsi.github.io/CommonDataModel/">OMOP Common Data Model (CDM)</a>.</p>
      <p>The image below shows a high-level diagram of how the native tables in the HESAPC database were mapped to the OMOP CDM. The main HESAPC tables converted include: (hes_patient, hes_diagnosis, hes_procedures_epi, hes_hospital, hes_acp and hes_episodes).</p>

     <h4>HES APC source Data Mapping for CDM v5.3 & CDM v5.4</h4>
	  <figure>
	  <img src="HES_APC/Images/image1.PNG" alt="HES APC Data mapping to OMOP CDM" class="img-fluid">
	  <figcaption><strong>Figure.1</strong></figcaption>
	  </figure>
	  <hr>
    </section>
	<section id="subsection1">
	    <h4>CDM Table: PERSON (CDM v5.3/ v5.4)</h4>
		<h5>Reading from HES_Patient</h5>
        <p>The patients mapped to the CDM from HES APC in this instance were restricted to those with a match_rank equal to one or two and had an entry in the hospital visit table, while the others were discarded.</p>
		<figure>
		<img src="HES_APC/Images/image2.png" alt="hes_patient mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.2</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>person_id</td>
				<td>patid</td>
				<td>If match_rank >= 3 discard patient (we accept only match_rank = 1 or match_rank = 2)</td>
				<td>If a patient has no entry in source_hesapc.hes_hospital, disregard it.Data like gender, 
					year_of_birth, location_id, Care_site_id comes from AURUM/GOLD as the data are linked to them.</td>
			</tr>
			<tr>
				<td>gender_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>year_of_birth</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>month_of_birth</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>day_of_birth</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>birth_datetime</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>race_concept_id</td>
				<td>gen_ethnicity</td>
				<td></td>
				<td>In OMOP, use "race" instead of "ethnicity", but at a later stage</td>
			</tr>
			<tr>
				<td>ethnicity_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>location_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>provider_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>person_source_value</td>
				<td>patid</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>gender_source_value</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>gender_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>race_source_value</td>
				<td>gen_ethnicity</td>
				<td></td>
				<td>In OMOP, use "race" instead of "ethnicity", but at a later stage</td>
			</tr>
			<tr>
				<td>race_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>ethnicity_source_value</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>ethnicity_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			</tbody>
		</table>
    </section>
	<hr>
	<section id="subsection2">
	<h4>CDM Table: PROVIDER (CDM v5.3 / v5.4)</h4>
		<h5>Reading from hes_episodes</h5>
		<figure>
		<img src="HES_APC/Images/image3.png" alt="hes_episode mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.3</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>provider_id</td>
				<td>pconsult</td>
				<td>Autogenerate </td>
				<td></td>
			</tr>
			<tr>
				<td>provider_name</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>npi</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>dea</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>specialty_concept_id</td>
				<td>tretspef</td>
				<td>If tretspef is not null then concept_id (tretspef) else 0, domain_id='provider' and Vocabulary_id='HES Specialty' and standard_concept='s'</td>
				<td>Mainspef are not unique per consultant, so better to record pairs of (consultatnt,soecialty) to be used across the episodes</td>
			</tr>
			<tr>
				<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>year_of_birth</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>gender_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>provider_source_value</td>
				<td>pconsult</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>specialty_source_value</td>
				<td>tretspef</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>specialty_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>gender_source_value</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>gender_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			</tbody>
		</table>	
	</section>
	<hr>
	<section id="subsection3">
	<h4>CDM Table: VISIT_OCCURRENCE (CDM v5.3 / v5.4)</h4>
		<h5>Reading from hes_hospital:</h5>
		<figure>
		<img src="HES_APC/Images/image6.png" alt="hes_hospital mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.4</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>visit_occurrence_id </td>
				<td></td>
				<td></td>
				<td>Autogenerate: if table is empty, start from MAX(public.visit_occurrence)+1</td>
			</tr>
			<tr>
				<td>person_id</td>
				<td>patid</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>visit_start_date</td>
				<td>admidate</td>
				<td>If admidate is null, use the first epistart in episode, and if also these are null, use discharged</td>
				<td>COALESCE(admidate, MIN(epistart), discharged)</td>
			</tr>
			<tr>
				<td>visit_start_datetime</td>
				<td>admidate</td>
				<td>If admidate is null, use the first epistart in episode, and if also these are null, use discharged</td>
				<td>COALESCE(admidate, MIN(epistart), discharged)</td>
			</tr>
			<tr>
				<td>visit_end_date</td>
				<td>discharged</td>
				<td>If discharged is null, use the last epiend in episode, and if also those are null, use admidate or the first of epistart</td>
				<td>COALESCE(discharged, MAX(epiend), admidate, MIN(epistart))</td>
			</tr>
			<tr>
				<td>visit_end_datetime</td>
				<td>discharged</td>
				<td>If discharged is null, use the last epiend in episode, and if also those are null, use admidate or the first of epistart</td>
				<td>COALESCE(discharged, MAX(epiend), admidate, MIN(epistart))</td>
			</tr>
			<tr>
				<td>visit_type_concept_id</td>
				<td></td>
				<td></td>
				<td>32818 = EHR administration record</td>
			</tr>
			<tr>
				<td>provider_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
			<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_source_value</td>
				<td>spno</td>
				<td></td>
				<td>This will allow us to retrieve visit_occurrence_id</td>
			</tr>
			<tr>
				<td>visit_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>admitting_source_concept_id <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>admimeth</td>
				<td></td>
				<td>Check for OMOP codes from admimeth</td>
			</tr>
			<tr>
				<td>admitting_source_value <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_value <br><strong>(CDM v5.4)</strong></td>
				<td>admimeth</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>discharge_to_concept_id</td>
				<td>dismeth</td>
				<td></td>
				<td>Check for OMOP codes from dismeth</td>
			</tr>
			<tr>
				<td>discharge_to_source_value</td>
				<td>dismeth</td>
				<td></td>
				<td>Definition to be added instead of number </td>
			</tr>
			<tr>
				<td>preceding_visit_occurrence_id</td>
				<td></td>
				<td></td>
				<td>Using person_id, look up the hospitalisation that occurs prior to this and put the visit_occurrence_id here (if there is time).</td>
			</tr>
			</tbody>
		</table>
    </section>
    <hr>
	<section id="subsection4">
	<h4>CDM Table: VISIT_DETAIL (CDM v5.3 / v5.4)</h4>
		<h5>Reading from hes_episodes:</h5>
		<figure>
		<img src="HES_APC/Images/image4.PNG" alt="hes_episode mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.6</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>visit_detail_id</td>
				<td></td>
				<td></td>
				<td>Autogenerate: if table is empty, starts from MAX(public.visit_detail) + 1 </td>
			</tr>
			<tr>
				<td>person_id</td>
				<td>patid</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_concept_id</td>
				<td></td>
				<td></td>
				<td>9201 = Inpatient visit</td>
			</tr>
			<tr>
			<td>visit_detail_start_date</td>
				<td>epistart</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_start_datetime</td>
				<td>epistart</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_date</td>
				<td>epiend</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_datetime</td>
				<td>epiend</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_type_concept_id</td>
				<td></td>
				<td></td>
				<td>32818  = "EHR administration record”</td>
			</tr>
			<tr>
				<td>provider_id</td>
				<td>pconsult,tretspef</td>
				<td></td>
				<td>Provider_id from PROVIDER using pconsult and tretspef</td>
			</tr>
			<tr>
			<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_source_value</td>
				<td>epikey</td>
				<td></td>
				<td>This will allow us to retrieve visit_detail_id using patid.</td>
			</tr>
			<tr>
				<td>visit_detail_source_concept_id</td>
				<td></td>
				<td></td>
				<td>32828</td>
			</tr>
			<tr>
				<td>admitting_source_value <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>admimeth</td>
				<td></td>
				<td>Check for OMOP codes from admimeth</td>
			</tr>
			<tr>
				<td>admitting_source_concept_id <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>admimeth</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>discharge_to_source_value</td>
				<td>dismeth</td>
				<td></td>
				<td>Check for OMOP codes from dismeth</td>
			</tr>
			<tr>
				<td>discharge_to_concept_id</td>
				<td>dismeth</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>preceding_visit_detail_id</td>
				<td>eorder</td>
				<td></td>
				<td>If eorder = 1 then 0 else check for preceding_visit_detail_id by using eorder for this patient using patid+epikey+spno</td>
			</tr>
			<tr>
				<td>visit_detail_parent_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_occurrence_id</td>
				<td></td>
				<td></td>
				<td>Use spno to retrieve visit_occurrence_id from visit_occurrence.visit_source_value</td>
			</tr>
			</tbody>
		</table>
        <h5>Reading from hes_acp:</h5>
		<figure>
		<img src="HES_APC/Images/image11.PNG" alt="hes_episode mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.7</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>visit_detail_id</td>
				<td></td>
				<td></td>
				<td>Autogenerate: if table is empty, starts from MAX(public.visit_detail) + 1 </td>
			</tr>
			<tr>
				<td>person_id</td>
				<td>patid</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_concept_id</td>
				<td></td>
				<td></td>
				<td>32037 = Intensive care</td>
			</tr>
			<tr>
			<td>visit_detail_start_date</td>
				<td>acpstar, epistart</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_start_datetime</td>
				<td>acpstar, epistart</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_date</td>
				<td>acpend, epiend</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_datetime</td>
				<td>epiend</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_type_concept_id</td>
				<td></td>
				<td></td>
				<td>32818  = "EHR administration record”</td>
			</tr>
			<tr>
				<td>provider_id</td>
				<td>hes_episodes.pconsult</td>
				<td></td>
				<td>Use patid+epikey to get it (only if efficient and provider populated)</td>
			</tr>
			<tr>
			<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_source_value</td>
				<td>epikey</td>
				<td></td>
				<td>This will allow us to retrieve visit_detail_id using patid.</td>
			</tr>
			<tr>
				<td>visit_detail_source_concept_id</td>
				<td>acpsour</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>admitting_source_value <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>acpsour</td>
				<td></td>
				<td>Check for OMOP codes from acpsour</td>
			</tr>
			<tr>
				<td>admitting_source_concept_id<br> <strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id<br> <strong>(CDM v5.4)</strong></td>
				<td>acpsour</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>discharge_to_source_value</td>
				<td>acpsour</td>
				<td></td>
				<td>Check for OMOP codes from acpsour</td>
			</tr>
			<tr>
				<td>discharge_to_concept_id</td>
				<td>acpsour</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>preceding_visit_detail_id</td>
				<td>acpn</td>
				<td></td>
				<td>If acpn = 1 then 0 else check for preceding_visit_detail_id by using acpn for this patient using patid+epikey+spno and visit_detail_source_value="Augmented care period (ACP)" to find the preceding_visit_detail_id</td>
			</tr>
			<tr>
				<td>visit_detail_parent_id<br><strong>(CDM v5.3)</strong>,<br> parent_visit_detail <br><strong>(CDM v5.4)</strong></td>
				<td></td>
				<td></td>
				<td>Use patid+epikey where visit_detail_source_value="visit episode" to get the visit_detail_parent_id/td>
			</tr>
			<tr>
				<td>visit_occurrence_id</td>
				<td></td>
				<td></td>
				<td>Use spno to retrieve visit_occurrence_id from visit_occurrence.visit_source_value</td>
			</tr>
			</tbody>
        </table>
        <h5>Reading from hes_ccare:</h5>
		<figure>
		<img src="HES_APC/Images/image10.PNG" alt="hes_episode mapping to CDM" class="img-fluid">
		<figcaption><strong>Figure.8</strong></figcaption>
		</figure>
		<table>
		  <thead>
			<tr>
			  <th>Destination_Field</th>
			  <th>Source_Field</th>
			  <th>Logic</th>
			  <th>Comment_Field</th>
			</tr>
		  </thead>
		  <!-- Table body rows -->
		  <tbody>
			<tr>
				<td>visit_detail_id</td>
				<td></td>
				<td></td>
				<td>Autogenerate: if table is empty, starts from MAX(public.visit_detail) + 1 </td>
			</tr>
			<tr>
				<td>person_id</td>
				<td>patid</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_concept_id</td>
				<td></td>
				<td></td>
				<td>32037 = Intensive care</td>
			</tr>
			<tr>
			<td>visit_detail_start_date</td>
				<td>ccstartdate</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_start_datetime</td>
				<td>ccstartdate</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_date</td>
				<td>ccdisdate</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_end_datetime</td>
				<td>ccdistime</td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_type_concept_id</td>
				<td></td>
				<td></td>
				<td>32818  = "EHR administration record”</td>
			</tr>
			<tr>
				<td>provider_id</td>
				<td>hes_episodes.pconsult</td>
				<td></td>
				<td>Use patid+epikey to get it (only if efficient and provider populated)</td>
			</tr>
			<tr>
			<td>care_site_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>visit_detail_source_value</td>
				<td>epikey</td>
				<td></td>
				<td>This will allow us to retrieve visit_detail_id set to 0 at the end.</td>
			</tr>
			<tr>
				<td>visit_detail_source_concept_id</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td>admitting_source_value <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>ccadmisorc</td>
				<td></td>
				<td>Check for OMOP codes from acpsour</td>
			</tr>
			<tr>
				<td>admitting_source_concept_id <br><strong>(CDM v5.3)</strong>,<br>admitting_from_source_concept_id <br><strong>(CDM v5.4)</strong></td>
				<td>ccadmisorc</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>discharge_to_source_value</td>
				<td>ccdisdest</td>
				<td></td>
				<td>Check for OMOP codes from ccdisdest</td>
			</tr>
			<tr>
				<td>discharge_to_concept_id</td>
				<td>ccdisdest</td>
				<td></td>
				<td>Definition to be added instead of number</td>
			</tr>
			<tr>
				<td>preceding_visit_detail_id</td>
				<td>acpn</td>
				<td></td>
				<td>If eorder = 1 then 0 else use eorder with patid+epikey to find the preceding_visit_detail_id</td>
			</tr>
			<tr>
				<td>visit_detail_parent_id <br><strong>(CDM v5.3)</strong>, <br>parent_visit_detail <br><strong>(CDM v5.4)</strong>,</td>
				<td></td>
				<td></td>
				<td>Use patid+epikey where visit_detail_source_value="visit episode" to get the visit_detail_parent_id/td>
			</tr>
			<tr>
				<td>visit_occurrence_id</td>
				<td></td>
				<td></td>
				<td>Use spno to retrieve visit_occurrence_id from visit_occurrence.visit_source_value</td>
			</tr>
			</tbody>
		</table>
    </section>
	<hr>
    <section id="subsection5">
	    <h4>CDM Table: STEM_TABLE (CDM v5.3/ v5.4)</h4>
        <p>The stem_table is a staging area where HESAPC source codes like Read codes will first be mapped to concept_ids.</p>
		<h5>Reading from hes_diagnosis_epi</h5>
        <figure>
            <img src="HES_APC/Images/image7.png" alt="hes_diagnosis mapping to CDM" class="img-fluid">
            <figcaption><strong>Figure.9</strong></figcaption>
        </figure>
        <table>
            <thead>
                <tr>
                  <th>Destination_Field</th>
                  <th>Source_Field</th>
                  <th>Logic</th>
                  <th>Comment_Field</th>
                </tr>
              </thead>
		  <!-- Table body rows -->
		  <tbody>
            <tr>
				<td>id</td>
				<td></td>
				<td></td>
                <td>Removed for performance reasons</td>
			</tr>
            <tr>
				<td>domain_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>person_id</td>
				<td></td>
				<td></td>
                <td>patid</td>
			</tr>
            <tr>
				<td>visit_occurrence_id</td>
				<td>spno, epikey</td>
				<td></td>
                <td>Use spno to retrieve visit_occurrence_id/td>
			</tr>
            <tr>
				<td>visit_detail_id</td>
				<td></td>
				<td></td>
                <td>Use patid+epikey to retrieve visit_detail_id</td>
			</tr>
            <tr>
				<td>provider_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>start_datetime</td>
				<td>epistart</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>concept_id</td>
				<td>icd</td>
				<td></td>
                <td>If there is no mapping the set to 0 and set domain_id as "Observation"</td>
			</tr>
            <tr>
				<td>source_value</td>
				<td>icd</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>source_concept_id</td>
				<td>icd</td>
				<td>concept_id of icd</td>
                <td></td>
			</tr>
            <tr>
				<td>type_concept_id</td>
				<td></td>
				<td></td>
                <td>32829</td>
			</tr>
            <tr>
				<td>operator_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unit_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unit_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>start_date</td>
				<td>epistart</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>end_date</td>
				<td>epiend</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>range_high</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>range_low</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_number</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_string</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>end_datetime</td>
				<td>epiend</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>verbatim_end_date</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>days_supply</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>dose_unit_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>lot_number</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>modifier_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>modifier_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>quantity</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>refills</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>route_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>route_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>sig</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>stop_reason</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unique_device_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>anatomic_site_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>disease_status_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>specimen_source_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>anatomic_site_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>disease_status_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>condition_status_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>condition_status_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
        </tbody>
        </table>
        <hr>
        <h5>Reading from hes_procedures_epi</h5>
        <figure>
            <img src="HES_APC/Images/image8.png" alt="hes_procedures_epi mapping to CDM" class="img-fluid">
            <figcaption><strong>Figure.10</strong></figcaption>
        </figure>
        <table>
            <thead>
                <tr>
                  <th>Destination_Field</th>
                  <th>Source_Field</th>
                  <th>Logic</th>
                  <th>Comment_Field</th>
                </tr>
              </thead>
		  <!-- Table body rows -->
		  <tbody>
            <tr>
				<td>id</td>
				<td></td>
				<td></td>
                <td>Removed for performance reasons</td>
			</tr>
            <tr>
				<td>domain_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>person_id</td>
				<td></td>
				<td></td>
                <td>patid</td>
			</tr>
            <tr>
				<td>visit_occurrence_id</td>
				<td>spno, epikey</td>
				<td></td>
                <td>Use spno to retrieve visit_occurrence_id/td>
			</tr>
            <tr>
				<td>visit_detail_id</td>
				<td></td>
				<td></td>
                <td>Use patid+epikey to retrieve visit_detail_id</td>
			</tr>
            <tr>
				<td>provider_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>start_datetime</td>
				<td>evdate, epistart</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>concept_id</td>
				<td>opcs</td>
				<td></td>
                <td>The codes in the opcs field are four digits with no decimal. To map these, add a decimal between the third and fourth digit. <br>
                LEFT JOIN source_to_source_vocab_map AS ss ON psts.opcs4 = ss.source_code AND ss.source_vocabulary_id = 'OPCS4' AND target_standard_concept='S' <br>
                AND target_invalid_reason is NULL <br><br>
                if domain_id is zero set to 'Observation'
            </td>
			</tr>
            <tr>
				<td>source_value</td>
				<td>opcs</td>
				<td>concept_id of opcs</td>
                <td></td>
			</tr>
            <tr>
				<td>source_concept_id</td>
				<td>opsc</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>type_concept_id</td>
				<td></td>
				<td></td>
                <td>32829</td>
			</tr>
            <tr>
				<td>operator_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unit_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unit_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>start_date</td>
				<td>evdate, epistart</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>end_date</td>
				<td>discharged, epiend</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>range_high</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>range_low</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_number</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_string</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_as_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>value_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>end_datetime</td>
				<td>discharged, epiend</td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>verbatim_end_date</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>days_supply</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>dose_unit_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>lot_number</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>modifier_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>modifier_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>quantity</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>refills</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>route_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>route_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>sig</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>stop_reason</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>unique_device_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>anatomic_site_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>disease_status_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>specimen_source_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>anatomic_site_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>disease_status_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>condition_status_concept_id</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
            <tr>
				<td>condition_status_source_value</td>
				<td></td>
				<td></td>
                <td></td>
			</tr>
        </tbody>
        </table>
        <hr>
      </section>
</div>
<!-- Bootstrap JS and Popper.js (required for Bootstrap) -->
<script src="https://code.jquery.com/jquery-3.6.4.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var dropdownButtons = document.querySelectorAll(".dropdown-btn");

    dropdownButtons.forEach(function (button) {
      button.addEventListener("click", function () {
        this.classList.toggle("active");
        var dropdownContent = this.nextElementSibling;
        if (dropdownContent.style.display === "block") {
          dropdownContent.style.display = "none";
        } else {
          dropdownContent.style.display = "block";
        }
      });
    });

    // Add the event listener to the navbar-toggler button
    document.querySelector(".navbar-toggler").addEventListener("click", function () {
      toggleSidebar();
    });

    // Add the event listener to the close-icon button
    document.querySelector(".close-icon").addEventListener("click", function () {
      toggleSidebar();
    });

  });
</script>

</body>
</html>